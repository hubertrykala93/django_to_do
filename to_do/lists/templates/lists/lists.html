{% extends 'core/base.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="side-content to-do-list-wrapper categories-wrapper" xmlns="http://www.w3.org/1999/html">
    <aside>
        <h4 class="sidebar-title categories-title">Categories</h4>
        {% if categories %}
        <ul class="categories-list">
            {% for category in categories %}
            <li data-id="{{ category.id }}">
                <span>{{ category }}</span>
                <button class="remove-category">
                    <i class="ri-delete-bin-line"></i>
                </button>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="no-items-message">No categories</p>
        {% endif %}

        <button class="btn add-category-btn" type="submit">
            <i class="ri-play-list-add-line"></i>
            Add Category
        </button>
    </aside>

    <div class="side-content-body to-do-list-contents categories-content-body">
        {% if categories %}
        {% for category in categories %}
        <div class="category-content" data-id="{{ category.id }}">
            <h3 class="category-title">{{ category }}</h3>

            <div id="user-form">
                <form class="register-form" method="post" action="">
                    {% csrf_token %}
                    <div class="form-row">
                        <div class="input-wrapper">
                            <label>{{ task_form.category.label }}</label>
                            {{ task_form.category }}
                            {% if task_form.category.errors %}
                            <ul class="errorlist">
                                {% for error in task_form.category.errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="input-wrapper">
                            <label>{{ task_form.name.label }}</label>
                            {{ task_form.name }}
                            {% if task_form.name.errors %}
                            <ul class="errorlist">
                                {% for error in task_form.name.errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="input-wrapper">
                            <label>{{ task_form.description.label }}</label>
                            {{ task_form.description }}
                            {% if task_form.description.errors %}
                            <ul class="errorlist">
                                {% for error in task_form.description.errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>

                    <div class="submit-row">
                        <button class="btn" type="submit" name="{{ task_form.prefix }}">Add Item</button>
                    </div>

                </form>
            </div>

            {% if tasks %}
            {% for task in tasks %}
            {% if task.category == category %}
            <ul class="tasks-list">
                <li>{{ task.name }}</li>
            </ul>
            {% endif %}
            {% endfor %}
            {% endif %}
        </div>
        {% endfor %}
        {% else %}
        <p class="no-items-message">No items in the current list. Add new ones.</p>
        {% endif %}
    </div>
</div>
{% endblock %}